---
title: Course Schedule II
directory: problems
tags:
  - topological-sort
date: 2022-10-31
---

### Prerequisite

- [course-schedule](/posts/207-course-schedule)

### Solution

- The same problem as [course-schedule](/posts/207-course-schedule) but instead of returning a boolean, return any of the valid topsort orderings.
- Use [[khans-algorithm]]

### Code

```python
class Solution:
    def findOrder(self, numCourses, prerequisites):
        in_count = {}
        adj_list = {}

        for i in range(numCourses):
            in_count[i] = 0
            adj_list[i] = []

        for p in prerequisites:
            child, parent = p
            in_count[child] += 1
            adj_list[parent].append(child)

        q = collections.deque()
        for k, v in in_count.items():
            if v == 0:
                q.append(k)

        valid_schedule = []
        while q:

            parent = q.popleft()
            valid_schedule.append(parent)

            for child in adj_list[parent]:
                in_count[child] -= 1
                if in_count[child] == 0:
                    q.append(child)

        if len(valid_schedule) != numCourses:
            return []

        return valid_schedule
```
