---
title: All Ancestors of a Node in a Directed Acyclic Graph
directory: problems
tags:
  - topological-sort
date: 2022-11-08
---

### Prerequisite

- [102-binary-tree-level-order-traversal](/posts/102-binary-tree-level-order-traversal)
- [207-course-schedule](/posts/course-schedule)

### Solution

- Use a very similar template to [course-schedule](/posts/course-schedule)
- For all nodes, push the current nodes value to all children AND push all of current nodes ancestors to all children

```python
result[child].add(parent) # add cur node value
result[child].update(result[parent]) # add all ancestors for current node
```

### Code

```python
class Solution:
    def getAncestors(self, n: int, edges):

        in_count = {}
        adj_list = {}

        for i in range(n):
            in_count[i] = 0
            adj_list[i] = []

        for edge in edges:
            parent, child = edge
            in_count[child] += 1
            adj_list[parent].append(child)

        q = collections.deque()
        for k, v in in_count.items():
            if v == 0:
                q.append(k)

        result = [set() for _ in range(n)]
        while q:

            parent = q.popleft()

            for child in adj_list[parent]:

                result[child].add(parent)
                result[child].update(result[parent])

                in_count[child] -= 1
                if in_count[child] == 0:
                    q.append(child)

        return [sorted(x) for x in result]

```
